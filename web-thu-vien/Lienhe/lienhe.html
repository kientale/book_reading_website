<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Th∆∞ vi·ªán Online</title>

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" defer></script>
    <script src="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/JS/main.js" defer></script>
    <link rel="stylesheet" href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/Lienhe/lienhe.css">
</head>

<body class="loading">
    <!-- Loading Animation -->
    <div id="loading"></div>
    <!-- Header -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">>
                <!-- Menu ch√≠nh -->
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 menu">
                    <li class="nav-item">
                        <a class="nav-link active"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/trangchu/trangchu.html">Trang
                            ch·ªß</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/GioiThieu/gioithieu.html">Gi·ªõi
                            thi·ªáu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/SanPham/sanpham.html">S·∫£n
                            ph·∫©m</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/Tintuc/tintuc.html">Tin
                            t·ª©c</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/Lienhe/lienhe.html">Li√™n
                            h·ªá</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            href="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/DangNhap_DangKy/DangNhap/dangnhap.html">ƒêƒÉng
                            nh·∫≠p</a>
                    </li>
                </ul>

                <!-- Form t√¨m ki·∫øm -->
                <form class="d-flex search-form">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Banner -->
        <section id="banner" class="d-flex align-items-center justify-content-center text-center">
            <div class="text-content">
                <h3>KTL - LIBRARY</h3>
                <h1>CLASS OF 2025</h1>
                <hr class="line">
            </div>
        </section>

        <!-- N·ªôi dung ch√≠nh -->
        <div class="main-content">
            <div class="contact-form-container">
                <h2 class="form-title">Li√™n H·ªá V·ªõi Ch√∫ng T√¥i</h2>
                <!-- Form -->
                <form class="contact-form" id="contactForm">
                    <div class="form-group">
                        <label for="name">H·ªç v√† T√™n</label>
                        <input type="text" id="name" name="name" placeholder="Nh·∫≠p h·ªç v√† t√™n" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="Nh·∫≠p email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" id="phone" name="phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
                    </div>
                    <div class="form-group">
                        <label for="address">ƒê·ªãa ch·ªâ</label>
                        <input type="text" id="address" name="address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ" required>
                    </div>
                    <div class="form-group">
                        <label for="message">L·ªùi Nh·∫Øn</label>
                        <textarea id="message" name="message" placeholder="Nh·∫≠p l·ªùi nh·∫Øn" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">G·ª≠i</button>
                </form>

                <!-- Th√¥ng b√°o g·ª≠i th√†nh c√¥ng -->
                <div id="success-message" style="display: none; color: green;">
                    G·ª≠i th√†nh c√¥ng! C·∫£m ∆°n b·∫°n ƒë√£ li√™n h·ªá v·ªõi ch√∫ng t√¥i.
                </div>
            </div>
            <!-- B·∫£n ƒë·ªì -->
            <div class="map-container">
                <h2 class="form-title">V·ªã Tr√≠ C·ªßa Ch√∫ng T√¥i</h2>
                <iframe
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3724.5739813749297!2d105.85315841541402!3d21.028511885998768!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135abc5f3333333%3A0x7dd7f9c8a4f4b123!2zSOG7jSBHw7luZyAoTGFrZSBPZiwgVGhpZSBQaG9uZyBNYXJrdCkgVG93ZXIgLSBIw7NhIE7hurRp!5e0!3m2!1svi!2s!4v1710345432123!5m2!1svi!2s"
                    width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy">
                </iframe>
                <div class="contact-info">
                    <h3>Th√¥ng Tin Li√™n H·ªá</h3>
                    <p><strong>üìç ƒê·ªãa ch·ªâ:</strong> 123 Nguy·ªÖn Tr√£i, H√† N·ªôi</p>
                    <p><strong>‚òéÔ∏è ƒêi·ªán tho·∫°i:</strong> 0123 456 789</p>
                    <p><strong>üìß Email:</strong> support@thuvienonline.com</p>
                    <p><strong>‚è∞ Gi·ªù m·ªü c·ª≠a:</strong> 8:00 - 21:00 (Th·ª© 2 - Ch·ªß Nh·∫≠t)</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i> Facebook</a> |
                        <a href="#"><i class="fab fa-zalo"></i> Zalo</a> |
                        <a href="#"><i class="fab fa-messenger"></i> Messenger</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Icons g√≥c d∆∞·ªõi b√™n ph·∫£i -->
        <div class="floating-icons">
            <a href="#" class="icon-btn chat-btn">
                <img src="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/img/man-2_icon-icons.com_55041.png"
                    alt="C√° nh√¢n">
            </a>
            <a href="#" class="icon-btn balo-btn" data-bs-toggle="modal" data-bs-target="#baloModal">
                <img src="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/img/shoppaymentorderbuy-34_icon-icons.com_73865.png"
                    alt="Balo">
            </a>
            <a href="#" class="icon-btn scroll-top-btn">
                <img src="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/img/arrow_circle_up_icon_155797.png"
                    alt="L√™n ƒë·∫ßu trang">
            </a>
            <a href="#" class="icon-btn scroll-top-btn" data-bs-toggle="modal" data-bs-target="#chatModal">
                <img src="http://localhost/PHP-project/Web%20Th%c6%b0%20vi%e1%bb%87n/img/social_facebook_messenger_icon-icons.com_66150.png"
                    alt="Chat">
            </a>
        </div>

        <div class="modal fade" id="chatModal" tabindex="-1" aria-labelledby="chatModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="chatModalLabel">Chat v·ªõi AI</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="chat-output" class="border p-3 mb-3" style="height: 250px; overflow-y: auto;"></div>
                        <div class="input-group">
                            <input type="text" id="chat-input" class="form-control" placeholder="Nh·∫≠p tin nh·∫Øn...">
                            <button id="sendMessage" class="btn btn-success">G·ª≠i</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const chatOutput = document.getElementById("chat-output");
                const chatInput = document.getElementById("chat-input");
                const sendMessage = document.getElementById("sendMessage");

                sendMessage.addEventListener("click", function () {
                    const userMessage = chatInput.value.trim();
                    if (userMessage === "") return;

                    // Hi·ªÉn th·ªã tin nh·∫Øn ng∆∞·ªùi d√πng
                    chatOutput.innerHTML += `<div><strong>B·∫°n:</strong> ${userMessage}</div>`;
                    chatInput.value = "";

                    // G·ª≠i ƒë·∫øn server ƒë·ªÉ x·ª≠ l√Ω AI
                    fetch("chat_ai.php", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ message: userMessage })
                    })
                        .then(response => response.json())
                        .then(data => {
                            chatOutput.innerHTML += `<div><strong>AI:</strong> ${data.reply}</div>`;
                            chatOutput.scrollTop = chatOutput.scrollHeight; // Cu·ªôn xu·ªëng tin nh·∫Øn m·ªõi nh·∫•t
                        })
                        .catch(error => console.error("L·ªói g·ª≠i tin nh·∫Øn:", error));
                });
            });
        </script>

        <!-- Modal Balo -->
        <div class="modal fade" id="baloModal" tabindex="-1" aria-labelledby="baloModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content p-3">
                    <div class="modal-header">
                        <h4 class="modal-title fw-bold" id="baloModalLabel">S√°ch ƒë√£ l∆∞u</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <ul id="savedBooksList" class="list-group">
                            <!-- Danh s√°ch s√°ch s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-lg btn-secondary" data-bs-dismiss="modal"> ƒê√≥ng</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                loadSavedBooks(); // G·ªçi h√†m t·∫£i s√°ch khi trang t·∫£i xong

                // S·ª± ki·ªán khi b·∫•m n√∫t "Th√™m v√†o balo"
                document.addEventListener("click", function (event) {
                    if (!event.target.classList.contains("btn-dark")) return;

                    let modal = event.target.closest(".modal");
                    if (!modal) return;

                    let title, author, year, imageSrc;
                    if (modal.id === "bookModal") {
                        title = document.getElementById("bookModalLabel").innerText;
                        author = document.getElementById("modalAuthor").innerText;
                        year = document.getElementById("modalYear").innerText;
                        imageSrc = document.getElementById("modalImage").src;
                    } else if (modal.id === "hotBookModal") {
                        title = document.getElementById("hotBookModalLabel").innerText;
                        author = document.getElementById("hotModalAuthor").innerText;
                        year = document.getElementById("hotModalYear").innerText;
                        imageSrc = document.getElementById("hotModalImage").src;
                    } else {
                        return;
                    }

                    const savedBooksList = document.getElementById("savedBooksList");

                    // ‚ùå Ki·ªÉm tra n·∫øu s√°ch ƒë√£ t·ªìn t·∫°i trong danh s√°ch th√¨ kh√¥ng th√™m n·ªØa
                    if ([...savedBooksList.children].some(li => li.dataset.title === title)) {
                        alert("S√°ch ƒë√£ t·ªìn t·∫°i trong balo!");
                        return;
                    }

                    // ‚úÖ Th√™m s√°ch v√†o danh s√°ch hi·ªÉn th·ªã
                    const listItem = document.createElement("li");
                    listItem.classList.add("list-group-item", "d-flex", "align-items-center", "justify-content-between");
                    listItem.dataset.title = title;

                    listItem.innerHTML = `
            <img src="${imageSrc}" class="rounded shadow border" style="width: 50px;">
            <span><strong>${title}</strong> - ${author} (${year})</span>
            <div class="saved-book-buttons">
                <button class="btn btn-sm btn-success">üìñ ƒê·ªçc ngay</button>
                <button class="btn btn-sm btn-danger">‚ùå X√≥a</button>
            </div>
        `;
                    savedBooksList.appendChild(listItem);

                    alert("S√°ch ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o balo!");

                    // üî• G·ª≠i d·ªØ li·ªáu l√™n server ƒë·ªÉ l∆∞u v√†o CSDL
                    fetch("save_book.php", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ title, author, year, image_url: imageSrc }),
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.status === "success") {
                                console.log("S√°ch ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o CSDL!");
                            } else {
                                console.error("L·ªói l∆∞u s√°ch:", data.message);
                            }
                        })
                        .catch(error => console.error("L·ªói g·ª≠i y√™u c·∫ßu:", error));
                });

                // S·ª± ki·ªán x√≥a s√°ch kh·ªèi danh s√°ch
                document.addEventListener("click", function (event) {
                    if (!event.target.classList.contains("btn-danger")) return;

                    let listItem = event.target.closest("li");
                    if (!listItem) return;

                    let title = listItem.dataset.title;

                    if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s√°ch "${title}" kh·ªèi balo?`)) return;

                    // ‚ùå Tr√°nh x√≥a 2 l·∫ßn b·∫±ng c√°ch ki·ªÉm tra s√°ch c√≥ t·ªìn t·∫°i kh√¥ng tr∆∞·ªõc khi g·ªçi API
                    if (!document.body.contains(listItem)) {
                        return;
                    }

                    fetch("xoa_saved_sach.php", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ ten_sach: title })
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                listItem.remove(); // ‚úÖ X√≥a kh·ªèi danh s√°ch hi·ªÉn th·ªã
                                alert("S√°ch ƒë√£ ƒë∆∞·ª£c x√≥a kh·ªèi balo!");
                            } else {
                                alert("L·ªói khi x√≥a s√°ch: " + data.message);
                            }
                        })
                        .catch(error => console.error("L·ªói g·ª≠i y√™u c·∫ßu x√≥a:", error));
                });

            });

            // H√†m t·∫£i s√°ch ƒë√£ l∆∞u t·ª´ CSDL
            function loadSavedBooks() {
                fetch("get_saved_books.php")
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === "success") {
                            const books = data.books;
                            const savedBooksList = document.getElementById("savedBooksList");
                            savedBooksList.innerHTML = ""; // X√≥a danh s√°ch c≈©

                            books.forEach(book => {
                                const listItem = document.createElement("li");
                                listItem.classList.add("list-group-item", "d-flex", "align-items-center", "justify-content-between");
                                listItem.dataset.title = book.book_title;

                                listItem.innerHTML = `
                        <img src="${book.image_url}" class="rounded shadow border" style="width: 50px;">
                        <span><strong>${book.book_title}</strong> - ${book.author} (${book.year})</span>
                        <div class="saved-book-buttons">
                            <button class="btn btn-sm btn-success">üìñ ƒê·ªçc ngay</button>
                            <button class="btn btn-sm btn-danger">‚ùå X√≥a</button>
                        </div>
                    `;
                                savedBooksList.appendChild(listItem);
                            });
                        } else {
                            console.error("L·ªói: ", data.message);
                        }
                    })
                    .catch(error => console.error("L·ªói khi t·∫£i s√°ch:", error));
            }


        </script>
        <!-- Popup (Modal) Bootstrap -->
        <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="userModalLabel">Th√¥ng tin ng∆∞·ªùi d√πng</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p><strong>H·ªç T√™n:</strong> <span id="popup-ho-ten"></span></p>
                        <p><strong>Email:</strong> <span id="popup-email"></span></p>
                        <p><strong>T√†i kho·∫£n:</strong> <span id="popup-username"></span></p>
                        <p><strong>Tu·ªïi:</strong> <span id="popup-tuoi"></span></p>
                        <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span id="popup-so-dien-thoai"></span></p>
                        <p><strong>ƒê·ªãa ch·ªâ:</strong> <span id="popup-dia-chi"></span></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" id="logoutBtn">
                            ƒêƒÉng xu·∫•t
                        </button>
                        <button type="button" class="btn btn-primary" id="editInfoBtn">
                            S·ª≠a th√¥ng tin
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal S·ª≠a Th√¥ng Tin -->
        <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel"
            aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editUserModalLabel">S·ª≠a Th√¥ng Tin</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editUserForm">
                            <div class="mb-3">
                                <label for="editHoTen" class="form-label">H·ªç T√™n</label>
                                <input type="text" class="form-control" id="editHoTen" required>
                            </div>
                            <div class="mb-3">
                                <label for="editTaiKhoan" class="form-label">T√†i Kho·∫£n</label>
                                <input type="text" class="form-control" id="editTaiKhoan" required>
                            </div>
                            <div class="mb-3">
                                <label for="editMatKhau" class="form-label">M·∫≠t Kh·∫©u</label>
                                <input type="password" class="form-control" id="editMatKhau" required>
                            </div>
                            <div class="mb-3">
                                <label for="editTuoi" class="form-label">Tu·ªïi</label>
                                <input type="number" class="form-control" id="editTuoi" required>
                            </div>
                            <div class="mb-3">
                                <label for="editEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="editEmail" required>
                            </div>
                            <div class="mb-3">
                                <label for="editSoDienThoai" class="form-label">S·ªë ƒêi·ªán Tho·∫°i</label>
                                <input type="text" class="form-control" id="editSoDienThoai" required>
                            </div>
                            <div class="mb-3">
                                <label for="editDiaChi" class="form-label">ƒê·ªãa Ch·ªâ</label>
                                <input type="text" class="form-control" id="editDiaChi" required>
                            </div>
                            <button type="submit" class="btn btn-primary">L∆∞u Thay ƒê·ªïi</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>


        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let editBtn = document.getElementById("editInfoBtn");

                if (!editBtn) {
                    console.error("Kh√¥ng t√¨m th·∫•y n√∫t #editInfoBtn.");
                    return;
                }

                editBtn.addEventListener("click", function () {
                    let hoTenElem = document.getElementById("popup-ho-ten");
                    let emailElem = document.getElementById("popup-email");
                    let usernameElem = document.getElementById("popup-username");
                    let tuoiElem = document.getElementById("popup-tuoi");
                    let soDienThoaiElem = document.getElementById("popup-so-dien-thoai");
                    let diaChiElem = document.getElementById("popup-dia-chi");

                    if (!hoTenElem || !emailElem || !usernameElem || !tuoiElem || !soDienThoaiElem || !diaChiElem) {
                        console.error("Kh√¥ng t√¨m th·∫•y m·ªôt trong c√°c ph·∫ßn t·ª≠ th√¥ng tin ng∆∞·ªùi d√πng.");
                        return;
                    }

                    let editHoTen = document.getElementById("editHoTen");
                    let editTaiKhoan = document.getElementById("editTaiKhoan");
                    let editMatKhau = document.getElementById("editMatKhau");
                    let editTuoi = document.getElementById("editTuoi");
                    let editEmail = document.getElementById("editEmail");
                    let editSoDienThoai = document.getElementById("editSoDienThoai");
                    let editDiaChi = document.getElementById("editDiaChi");

                    if (!editHoTen || !editTaiKhoan || !editMatKhau || !editTuoi || !editEmail || !editSoDienThoai || !editDiaChi) {
                        console.error("Kh√¥ng t√¨m th·∫•y m·ªôt trong c√°c ph·∫ßn t·ª≠ form ch·ªânh s·ª≠a.");
                        return;
                    }

                    editHoTen.value = hoTenElem.textContent.trim();
                    editTaiKhoan.value = usernameElem.textContent.trim();
                    editMatKhau.value = "";
                    editTuoi.value = tuoiElem.textContent.trim();
                    editEmail.value = emailElem.textContent.trim();
                    editSoDienThoai.value = soDienThoaiElem.textContent.trim();
                    editDiaChi.value = diaChiElem.textContent.trim();

                    let editModalElem = document.getElementById("editUserModal");
                    if (!editModalElem) {
                        console.error("Kh√¥ng t√¨m th·∫•y modal #editUserModal.");
                        return;
                    }

                    let editModal = new bootstrap.Modal(editModalElem);
                    editModal.show();
                });

                let editUserForm = document.getElementById("editUserForm");
                if (!editUserForm) {
                    console.error("Kh√¥ng t√¨m th·∫•y form #editUserForm.");
                    return;
                }

                editUserForm.addEventListener("submit", function (event) {
                    event.preventDefault();

                    let updatedUserInfo = {
                        taiKhoan: document.getElementById("editTaiKhoan").value.trim(),
                        matKhau: document.getElementById("editMatKhau").value.trim(),
                        hoTen: document.getElementById("editHoTen").value.trim(),
                        tuoi: document.getElementById("editTuoi").value.trim(),
                        email: document.getElementById("editEmail").value.trim(),
                        soDienThoai: document.getElementById("editSoDienThoai").value.trim(),
                        diaChi: document.getElementById("editDiaChi").value.trim(),
                    };

                    console.log("D·ªØ li·ªáu g·ª≠i ƒëi:", updatedUserInfo);

                    fetch("suathongtin.php", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(updatedUserInfo),
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log("Ph·∫£n h·ªìi t·ª´ server:", data);
                            if (data.success) {
                                alert("C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng!");
                                // C·∫≠p nh·∫≠t n·ªôi dung modal ngay l·∫≠p t·ª©c
                                document.getElementById("popup-ho-ten").innerText = updatedUserInfo.hoTen;
                                document.getElementById("popup-email").innerText = updatedUserInfo.email;
                                document.getElementById("popup-username").innerText = updatedUserInfo.taiKhoan;
                                document.getElementById("popup-tuoi").innerText = updatedUserInfo.tuoi;
                                document.getElementById("popup-so-dien-thoai").innerText = updatedUserInfo.soDienThoai;
                                document.getElementById("popup-dia-chi").innerText = updatedUserInfo.diaChi;

                                // C·∫≠p nh·∫≠t cookie ƒë·ªÉ gi·ªØ th√¥ng tin m·ªõi
                                document.cookie = `hoTen=${encodeURIComponent(updatedUserInfo.hoTen)}; path=/`;
                                document.cookie = `email=${encodeURIComponent(updatedUserInfo.email)}; path=/`;
                                document.cookie = `username=${encodeURIComponent(updatedUserInfo.taiKhoan)}; path=/`;
                                document.cookie = `tuoi=${encodeURIComponent(updatedUserInfo.tuoi)}; path=/`;
                                document.cookie = `soDienThoai=${encodeURIComponent(updatedUserInfo.soDienThoai)}; path=/`;
                                document.cookie = `diaChi=${encodeURIComponent(updatedUserInfo.diaChi)}; path=/`;
                            } else {
                                alert("L·ªói: " + data.error);
                            }
                        })
                        .catch(error => {
                            console.error("L·ªói khi g·ª≠i y√™u c·∫ßu:", error);
                            alert("C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t. Vui l√≤ng th·ª≠ l·∫°i.");
                        });
                });
            });


            // ƒê·ª£i DOM load tr∆∞·ªõc khi ch·∫°y script
            document.addEventListener("DOMContentLoaded", function () {
                // H√†m l·∫•y gi√° tr·ªã t·ª´ cookie
                function getCookie(name) {
                    let cookies = document.cookie.split("; ");
                    for (let i = 0; i < cookies.length; i++) {
                        let parts = cookies[i].split("=");
                        if (parts[0] === name) {
                            return decodeURIComponent(parts[1]);
                        }
                    }
                    return ""; // Tr·∫£ v·ªÅ chu·ªói r·ªóng n·∫øu kh√¥ng t√¨m th·∫•y
                }

                // Hi·ªÉn th·ªã th√¥ng tin ng∆∞·ªùi d√πng khi m·ªü modal
                let chatButton = document.querySelector(".chat-btn");
                if (chatButton) {
                    chatButton.addEventListener("click", function () {
                        let hoTenEl = document.getElementById("popup-ho-ten");
                        let emailEl = document.getElementById("popup-email");
                        let usernameEl = document.getElementById("popup-username");
                        let tuoiEl = document.getElementById("popup-tuoi");
                        let soDienThoaiEl = document.getElementById("popup-so-dien-thoai");
                        let diaChiEl = document.getElementById("popup-dia-chi");

                        // Ki·ªÉm tra xem c√°c ph·∫ßn t·ª≠ c√≥ t·ªìn t·∫°i tr∆∞·ªõc khi g√°n gi√° tr·ªã
                        if (hoTenEl && emailEl && usernameEl && tuoiEl && soDienThoaiEl && diaChiEl) {
                            hoTenEl.innerText = getCookie("hoTen") || "Ch∆∞a ƒëƒÉng nh·∫≠p";
                            emailEl.innerText = getCookie("email") || "Ch∆∞a ƒëƒÉng nh·∫≠p";
                            usernameEl.innerText = getCookie("username") || "Ch∆∞a ƒëƒÉng nh·∫≠p";
                            tuoiEl.innerText = getCookie("tuoi") || "Ch∆∞a c√≥ d·ªØ li·ªáu";
                            soDienThoaiEl.innerText = getCookie("soDienThoai") || "Ch∆∞a c√≥ d·ªØ li·ªáu";
                            diaChiEl.innerText = getCookie("diaChi") || "Ch∆∞a c√≥ d·ªØ li·ªáu";
                        } else {
                            console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ hi·ªÉn th·ªã th√¥ng tin ng∆∞·ªùi d√πng.");
                        }
                    });
                } else {
                    console.error("Kh√¥ng t√¨m th·∫•y n√∫t m·ªü modal. Ki·ªÉm tra l·∫°i class.");
                }
            });

            document.addEventListener("DOMContentLoaded", function () {
                let logoutBtn = document.getElementById("logoutBtn");

                if (!logoutBtn) {
                    console.error("Kh√¥ng t√¨m th·∫•y n√∫t ƒëƒÉng xu·∫•t.");
                    return;
                }

                logoutBtn.addEventListener("click", function () {
                    if (!document.cookie.includes("username=")) {
                        alert("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!");
                        return;
                    }

                    // H√†m x√≥a cookie
                    function deleteCookie(name) {
                        document.cookie = name + "=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
                        document.cookie = name + "=; path=/; domain=" + window.location.hostname + "; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
                    }

                    // X√≥a danh s√°ch cookie li√™n quan ƒë·∫øn t√†i kho·∫£n
                    ["username", "hoTen", "email", "tuoi", "soDienThoai", "diaChi"].forEach(deleteCookie);

                    // Log ƒë·ªÉ ki·ªÉm tra
                    console.log("Cookies sau khi x√≥a:", document.cookie);

                    // C·∫≠p nh·∫≠t giao di·ªán (t·∫£i l·∫°i trang)
                    alert("B·∫°n ƒë√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!");
                    window.location.reload();
                });
            });



            document.addEventListener("DOMContentLoaded", function () {
                document.querySelector(".chat-btn").addEventListener("click", function (event) {
                    event.preventDefault(); // NgƒÉn t·∫£i l·∫°i trang
                    var myModal = new bootstrap.Modal(document.getElementById('userModal'));
                    myModal.show();
                });
            });
        </script>
    </main>
    <!-- Footer -->
    <footer class="footer" style="background-color:#873e23; height: 200px;">
    </footer>

    <script>
        // Khi trang ƒë√£ t·∫£i xong
        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("contactForm");
            const successMessage = document.getElementById("success-message");

            form.addEventListener("submit", function (event) {
                event.preventDefault(); // NgƒÉn form submit m·∫∑c ƒë·ªãnh

                // Thu th·∫≠p d·ªØ li·ªáu form
                const formData = new FormData(form);

                // G·ª≠i form b·∫±ng AJAX
                fetch('lienhe.php', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => response.text())
                    .then(data => {
                        // Ki·ªÉm tra k·∫øt qu·∫£ v√† hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
                        if (data.includes("G·ª≠i th√†nh c√¥ng")) {
                            successMessage.style.display = "block";
                        } else {
                            alert("ƒê√£ c√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i.");
                        }
                    })
                    .catch(error => {
                        console.error('L·ªói khi g·ª≠i form:', error);
                        alert("C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i.");
                    });
            });
        });

        document.body.classList.add('loading');

        document.addEventListener("DOMContentLoaded", function () {
            setTimeout(function () {
                document.body.classList.remove('loading');
                document.body.classList.add('loaded');
            }, 1500);
            console.log("Trang ƒë√£ t·∫£i xong!");
        });

        document.addEventListener("DOMContentLoaded", function () {
            const loginForm = document.getElementById("login-form");

            if (loginForm) {
                loginForm.addEventListener("submit", function (e) {
                    e.preventDefault();

                    const username = document.getElementById("username").value;
                    const password = document.getElementById("password").value;

                    loginForm.submit();
                });
            }
        });
    </script>
</body>

</html>